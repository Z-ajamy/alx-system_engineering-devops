#!/usr/bin/env bash

# Function to fetch and display subdomain information
get_subdomain_info() {
    local domain=$1
    local subdomain=$2
    local fqdn="${subdomain}.${domain}"

    # Fetch DNS information
    local result=$(dig +short "$fqdn")
    if [[ -z "$result" ]]; then
        echo "No information available for ${fqdn}"
        return
    fi

    # Extract record type and destination
    local record_type=$(dig "$fqdn" | awk '/ANSWER SECTION:/ {getline; print $4}')
    local destination=$(dig "$fqdn" | awk '/ANSWER SECTION:/ {getline; print $5}')

    # Output the result
    echo "The subdomain ${subdomain} is a ${record_type} record and points to ${destination}"
}

# Check if domain is provided
if [[ -z "$1" ]]; then
    echo "Domain parameter is required"
    exit 1
fi

domain=$1
subdomain=$2

# Display information for default subdomains if no specific subdomain is provided
if [[ -z "$subdomain" ]]; then
    for sub in www lb-01 web-01 web-02; do
        get_subdomain_info "$domain" "$sub"
    done
else
    get_subdomain_info "$domain" "$subdomain"
fi
